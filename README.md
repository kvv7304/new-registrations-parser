
# Siberian Wellness Registration Parser

## Описание

Этот проект предназначен для парсинга электронных писем, связанных с новыми регистрациями в команде Siberian Wellness, и сохранения их в формате CSV. Скрипт автоматически авторизуется в backoffice Siberian Wellness, скачивает необходимые данные и обрабатывает письма из указанного почтового ящика.

## Содержимое

- `main.py`: Основной скрипт для парсинга и обработки писем, а также сохранения данных в CSV.
- `main_v2.py`: Улучшенная версия основного скрипта с использованием классов для лучшей организации кода.
- `backoffice.py`: Модуль для авторизации и получения данных из backoffice Siberian Wellness.
- `config_sample.py`: Пример конфигурационного файла с настройками для подключения к почтовому ящику и другим параметрам. Вы можете использовать его для создания вашего `config.py`.

## Использование

### Конфигурация

Перед использованием, настройте файл `config.py` с вашими данными:
```python
# Пример ключа капчи
CAPTCHA_KEY = "sample_captcha_key"

# Пример данных пользователя
USER = {
    "number": "sample_number",
    "password": "sample_password"
}

# Пример данных для почты
MAIL_LOGIN = "sample_mail_login"
MAIL_PASSWORD = "sample_mail_password"
MAILBOX = "sample_mailbox"
MAIL_SERVER = "imap.mail.RU"
```

## Различия между версиями

### `main.py`

- Скрипт организован в виде функций.
- Парсинг почтового ящика и сохранение данных происходит в одном файле.
- Меньше модульности, что делает его менее удобным для расширения и поддержки.

### `main_v2.py`

- Скрипт рефакторирован с использованием классов `EmailParser` и `CSVWriter`.
- Лучшая организация кода и разделение ответственности между классами.
- Упрощенная модификация и расширение функциональности.
- Код становится более читаемым и поддерживаемым.